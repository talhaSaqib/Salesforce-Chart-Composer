"use strict";
// This file is copied straight from Prettier's JS implementation,
// since everything works exactly the same for Apex code.
Object.defineProperty(exports, "__esModule", { value: true });
exports.insertPragma = exports.hasPragma = void 0;
const jest_docblock_1 = require("jest-docblock");
function hasPragma(text) {
    const pragmas = Object.keys((0, jest_docblock_1.parse)((0, jest_docblock_1.extract)(text)));
    return pragmas.indexOf("prettier") !== -1 || pragmas.indexOf("format") !== -1;
}
exports.hasPragma = hasPragma;
function insertPragma(text) {
    const parsedDocblock = (0, jest_docblock_1.parseWithComments)((0, jest_docblock_1.extract)(text));
    const pragmas = { format: "", ...parsedDocblock.pragmas };
    const newDocblock = (0, jest_docblock_1.print)({
        pragmas,
        comments: parsedDocblock.comments.replace(/^(\s+?\r?\n)+/, ""), // remove leading newlines
    }).replace(/(\r\n|\r)/g, "\n"); // normalise newlines (mitigate use of os.EOL by jest-docblock)
    const strippedText = (0, jest_docblock_1.strip)(text);
    const separatingNewlines = strippedText.startsWith("\n") ? "\n" : "\n\n";
    return newDocblock + separatingNewlines + strippedText;
}
exports.insertPragma = insertPragma;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJhZ21hLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3ByYWdtYS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsa0VBQWtFO0FBQ2xFLHlEQUF5RDs7O0FBRXpELGlEQUFnRjtBQUVoRixTQUFnQixTQUFTLENBQUMsSUFBWTtJQUNwQyxNQUFNLE9BQU8sR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUEscUJBQUssRUFBQyxJQUFBLHVCQUFPLEVBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2xELE9BQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxPQUFPLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0FBQ2hGLENBQUM7QUFIRCw4QkFHQztBQUVELFNBQWdCLFlBQVksQ0FBQyxJQUFZO0lBQ3ZDLE1BQU0sY0FBYyxHQUFHLElBQUEsaUNBQWlCLEVBQUMsSUFBQSx1QkFBTyxFQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDeEQsTUFBTSxPQUFPLEdBQUcsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFLEdBQUcsY0FBYyxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQzFELE1BQU0sV0FBVyxHQUFHLElBQUEscUJBQUssRUFBQztRQUN4QixPQUFPO1FBQ1AsUUFBUSxFQUFFLGNBQWMsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLGVBQWUsRUFBRSxFQUFFLENBQUMsRUFBRSwwQkFBMEI7S0FDM0YsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQywrREFBK0Q7SUFDL0YsTUFBTSxZQUFZLEdBQUcsSUFBQSxxQkFBSyxFQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2pDLE1BQU0sa0JBQWtCLEdBQUcsWUFBWSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUM7SUFDekUsT0FBTyxXQUFXLEdBQUcsa0JBQWtCLEdBQUcsWUFBWSxDQUFDO0FBQ3pELENBQUM7QUFWRCxvQ0FVQyJ9